<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèí –î–•–õ –•–û–ö–ö–ï–ô –õ–ò–ì–ê</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --black: #0a0a0a;
            --dark-gray: #1a1a1a;
            --gray: #2a2a2a;
            --red: #ff003c;
            --dark-red: #e10600;
            --blue: #00a8ff;
            --green: #2ecc71;
            --yellow: #f1c40f;
            --white: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }
        
        body {
            background-color: var(--black);
            color: var(--white);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* –õ–µ–¥—è–Ω–æ–π —Ñ–æ–Ω */
        .ice-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 49%, rgba(255, 255, 255, 0.03) 50%, transparent 51%),
                linear-gradient(-45deg, transparent 49%, rgba(255, 255, 255, 0.03) 50%, transparent 51%);
            background-size: 60px 60px;
            background-color: #0a1a2a;
            pointer-events: none;
            z-index: -2;
        }
        
        /* –õ–µ–¥—è–Ω—ã–µ —Ü–∞—Ä–∞–ø–∏–Ω—ã –ø–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–∞ */
        .ice-scratches {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(45deg, transparent 49.5%, rgba(0, 168, 255, 0.05) 50%, transparent 50.5%),
                linear-gradient(-45deg, transparent 49.5%, rgba(0, 168, 255, 0.05) 50%, transparent 50.5%),
                linear-gradient(30deg, transparent 49.8%, rgba(255, 255, 255, 0.02) 50%, transparent 50.2%),
                linear-gradient(-30deg, transparent 49.8%, rgba(255, 255, 255, 0.02) 50%, transparent 50.2%);
            background-size: 80px 80px, 80px 80px, 100px 100px, 100px 100px;
            pointer-events: none;
            z-index: -1;
            animation: iceShimmer 20s linear infinite;
        }
        
        @keyframes iceShimmer {
            0% { background-position: 0 0, 0 0, 0 0, 0 0; }
            100% { background-position: 80px 80px, 80px 80px, 100px 100px, 100px 100px; }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* –®–∞–ø–∫–∞ */
        .header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 30px;
            position: relative;
            background: linear-gradient(90deg, rgba(255,0,60,0.1) 0%, rgba(0,168,255,0.1) 100%);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--red), var(--blue), transparent);
        }
        
        .logo {
            font-size: 64px;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--red), var(--blue));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(255, 0, 60, 0.3);
        }
        
        .title {
            font-size: 48px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--white), #f0f0f0, #d0d0d0);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            color: #aaa;
            font-size: 18px;
            font-weight: 500;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: rgba(26, 26, 26, 0.8);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .nav-btn {
            background: linear-gradient(45deg, var(--dark-gray), var(--gray));
            border: 2px solid transparent;
            color: var(--white);
            padding: 15px 30px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 200px;
            justify-content: center;
        }
        
        .nav-btn:hover {
            background: linear-gradient(45deg, var(--red), var(--dark-red));
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 20px rgba(255, 0, 60, 0.3);
        }
        
        .nav-btn.active {
            background: linear-gradient(45deg, var(--red), var(--blue));
            border-color: var(--red);
            box-shadow: 0 0 30px rgba(255, 0, 60, 0.5);
        }
        
        /* –°–µ–∫—Ü–∏–∏ */
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 30px;
            color: var(--red);
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: rgba(26, 26, 26, 0.8);
            border-radius: 15px;
            border-left: 5px solid var(--red);
        }
        
        .section-title::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, var(--red), transparent);
        }
        
        /* –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ */
        .standings-container {
            background: rgba(26, 26, 26, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }
        
        .standings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .standings-table thead {
            background: linear-gradient(90deg, var(--red), var(--dark-red));
        }
        
        .standings-table th {
            padding: 20px 15px;
            text-align: left;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 14px;
        }
        
        .standings-table tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .standings-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(10px);
        }
        
        .standings-table tbody tr.playoff {
            background: rgba(255, 0, 60, 0.05);
            border-left: 4px solid var(--red);
        }
        
        .standings-table td {
            padding: 18px 15px;
        }
        
        .team-cell {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .team-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 20px;
            border: 3px solid var(--red);
            box-shadow: 0 0 15px rgba(255, 0, 60, 0.3);
        }
        
        /* –ö–∞–ª–µ–Ω–¥–∞—Ä—å */
        .calendar-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .match-day {
            background: rgba(26, 26, 26, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-top: 4px solid var(--blue);
            transition: all 0.3s ease;
        }
        
        .match-day:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .match-date {
            font-size: 18px;
            font-weight: 700;
            color: var(--blue);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .match {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(42, 42, 42, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
        }
        
        .match:hover {
            background: rgba(42, 42, 42, 0.8);
        }
        
        .match-teams {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .match-team {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }
        
        .match-logo {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--gray);
            border: 2px solid var(--red);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .match-vs {
            margin: 0 10px;
            color: var(--blue);
            font-weight: 900;
            font-size: 12px;
            background: rgba(0,168,255,0.1);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .match-score {
            font-weight: 900;
            font-size: 20px;
            color: var(--white);
            min-width: 70px;
            text-align: center;
            background: rgba(255,0,60,0.1);
            padding: 8px 15px;
            border-radius: 8px;
            border: 2px solid rgba(255,0,60,0.3);
        }
        
        .match-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        /* –ü–ª–µ–π-–æ—Ñ—Ñ */
        .playoff-container {
            background: rgba(26, 26, 26, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .playoff-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 49%, rgba(0, 168, 255, 0.1) 50%, transparent 51%),
                linear-gradient(-45deg, transparent 49%, rgba(0, 168, 255, 0.1) 50%, transparent 51%);
            background-size: 100px 100px;
            pointer-events: none;
            z-index: 0;
        }
        
        .playoff-grid {
            display: flex;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 30px;
        }
        
        .playoff-round {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .round-title {
            text-align: center;
            font-weight: 800;
            text-transform: uppercase;
            color: var(--red);
            padding: 15px;
            background: rgba(255,0,60,0.1);
            border-radius: 10px;
            font-size: 18px;
            border: 2px solid rgba(255,0,60,0.3);
        }
        
        .matchup {
            background: rgba(42, 42, 42, 0.9);
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid var(--red);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .team-match {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .team-match:last-child {
            border-bottom: none;
        }
        
        .cup-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            background: rgba(42, 42, 42, 0.9);
            border-radius: 15px;
            border: 2px solid rgba(200, 200, 200, 0.3);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
        }
        
        .cup {
            width: 120px;
            height: 180px;
            background: linear-gradient(45deg, #b0b0b0, #ffffff, #c0c0c0);
            border-radius: 10px 10px 40px 40px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.2);
        }
        
        .cup::before {
            content: '';
            position: absolute;
            width: 140px;
            height: 40px;
            background: linear-gradient(45deg, #b0b0b0, #ffffff, #c0c0c0);
            border-radius: 20px;
            bottom: -20px;
            left: -10px;
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
        }
        
        .cup-name {
            font-size: 20px;
            font-weight: 900;
            color: var(--red);
            text-shadow: 0 2px 10px rgba(255, 0, 60, 0.5);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-section {
            background: rgba(26, 26, 26, 0.9);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--blue);
            box-shadow: 0 0 40px rgba(0, 168, 255, 0.2);
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .admin-tab {
            background: rgba(42, 42, 42, 0.8);
            border: 2px solid transparent;
            color: var(--white);
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            text-align: center;
        }
        
        .admin-tab:hover {
            background: rgba(0, 168, 255, 0.2);
            border-color: var(--blue);
        }
        
        .admin-tab.active {
            background: var(--blue);
            box-shadow: 0 0 20px rgba(0, 168, 255, 0.5);
        }
        
        .admin-content {
            display: none;
        }
        
        .admin-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--blue);
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: var(--white);
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--blue);
            box-shadow: 0 0 15px rgba(0, 168, 255, 0.3);
        }
        
        .btn {
            background: linear-gradient(45deg, var(--red), var(--dark-red));
            color: var(--white);
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn:hover {
            background: linear-gradient(45deg, var(--dark-red), var(--red));
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 0, 60, 0.3);
        }
        
        .btn-blue {
            background: linear-gradient(45deg, var(--blue), #0097e6);
        }
        
        .btn-blue:hover {
            background: linear-gradient(45deg, #0097e6, var(--blue));
            box-shadow: 0 10px 20px rgba(0, 168, 255, 0.3);
        }
        
        .btn-green {
            background: linear-gradient(45deg, var(--green), #27ae60);
        }
        
        .btn-green:hover {
            background: linear-gradient(45deg, #27ae60, var(--green));
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
        }
        
        .message {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .message.show {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        .message.success {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid var(--green);
            color: var(--green);
        }
        
        .message.error {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid #e74c3c;
            color: #e74c3c;
        }
        
        .message.warning {
            background: rgba(241, 196, 15, 0.2);
            border: 2px solid var(--yellow);
            color: var(--yellow);
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stats-card {
            background: rgba(26, 26, 26, 0.8);
            padding: 25px;
            border-radius: 15px;
            border-top: 4px solid var(--red);
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 0, 60, 0.2);
        }
        
        .stats-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--red);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        /* –ò–Ω—Ñ–æ –ø–∞–Ω–µ–ª—å */
        .info-panel {
            background: rgba(26, 26, 26, 0.9);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .info-text {
            color: #aaa;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .sync-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            color: var(--green);
            font-weight: 600;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--dark-gray);
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            border: 2px solid var(--red);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .title {
                font-size: 32px;
            }
            
            .nav {
                gap: 10px;
                padding: 15px;
            }
            
            .nav-btn {
                padding: 12px 20px;
                font-size: 12px;
                min-width: 140px;
            }
            
            .calendar-grid {
                grid-template-columns: 1fr;
            }
            
            .playoff-grid {
                flex-direction: column;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-tab {
                min-width: 120px;
                padding: 12px 15px;
                font-size: 12px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                font-size: 24px;
                padding: 15px;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            text-align: center;
            padding: 40px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--red);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- –õ–µ–¥—è–Ω–æ–π —Ñ–æ–Ω -->
    <div class="ice-background"></div>
    <div class="ice-scratches"></div>
    
    <div class="container">
        <!-- –®–ê–ü–ö–ê -->
        <div class="header">
            <div class="logo">üèí</div>
            <h1 class="title">–î–•–õ –•–û–ö–ö–ï–ô –õ–ò–ì–ê</h1>
            <p class="subtitle" id="siteSubtitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ö–æ–∫–∫–µ–π –±—É–¥—É—â–µ–≥–æ ‚Ä¢ –°–µ–∑–æ–Ω 2024 ‚Ä¢ –ö—É–±–æ–∫ –•–æ–ª–æ–¥–Ω–æ–≥–æ –ü—É—Ç–∏</p>
        </div>
        
        <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
        <div class="nav">
            <button class="nav-btn active" data-section="standings">
                <i class="fas fa-trophy"></i> –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
            </button>
            <button class="nav-btn" data-section="calendar">
                <i class="fas fa-calendar-alt"></i> –ö–∞–ª–µ–Ω–¥–∞—Ä—å –º–∞—Ç—á–µ–π
            </button>
            <button class="nav-btn" data-section="playoff">
                <i class="fas fa-fire"></i> –ö—É–±–æ–∫ –•–æ–ª–æ–¥–Ω–æ–≥–æ –ü—É—Ç–∏
            </button>
            <button class="nav-btn" data-section="stats">
                <i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </button>
            <button class="nav-btn" data-section="admin">
                <i class="fas fa-cog"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            </button>
        </div>
        
        <!-- –¢–£–†–ù–ò–†–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê -->
        <section class="section active" id="standings">
            <h2 class="section-title">
                <i class="fas fa-trophy"></i> –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –î–•–õ
            </h2>
            <div class="standings-container">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <div style="width: 10px; height: 10px; background: var(--red); border-radius: 2px;"></div>
                            <span style="font-size: 12px;">–ü–ª–µ–π-–æ—Ñ—Ñ</span>
                        </div>
                    </div>
                    <div style="color: #aaa; font-size: 14px;">
                        –û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="lastUpdated">—Ç–æ–ª—å–∫–æ —á—Ç–æ</span>
                    </div>
                </div>
                <table class="standings-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">#</th>
                            <th>–ö–æ–º–∞–Ω–¥–∞</th>
                            <th style="width: 80px;">–ò</th>
                            <th style="width: 80px;">–í</th>
                            <th style="width: 80px;">–ü</th>
                            <th style="width: 80px;">–û</th>
                            <th style="width: 100px;">–§–æ—Ä–º–∞</th>
                        </tr>
                    </thead>
                    <tbody id="standingsBody">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- –ö–ê–õ–ï–ù–î–ê–†–¨ –ú–ê–¢–ß–ï–ô -->
        <section class="section" id="calendar">
            <h2 class="section-title">
                <i class="fas fa-calendar-alt"></i> –ö–∞–ª–µ–Ω–¥–∞—Ä—å –º–∞—Ç—á–µ–π —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ —á–µ–º–ø–∏–æ–Ω–∞—Ç–∞
            </h2>
            <div class="calendar-controls">
                <button class="btn btn-blue" onclick="simulateAllMatches()">
                    <i class="fas fa-dice"></i> –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–∞—Ç—á–∏
                </button>
                <button class="btn" onclick="generateRegularSeason()">
                    <i class="fas fa-redo"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–∫—É
                </button>
                <button class="btn btn-green" onclick="showAddMatchModal()">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á
                </button>
            </div>
            <div class="calendar-grid" id="calendarGrid">
                <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
            </div>
        </section>
        
        <!-- –ü–õ–ï–ô-–û–§–§ -->
        <section class="section" id="playoff">
            <h2 class="section-title">
                <i class="fas fa-fire"></i> –ö—É–±–æ–∫ –•–æ–ª–æ–¥–Ω–æ–≥–æ –ü—É—Ç–∏ - –ü–ª–µ–π-–æ—Ñ—Ñ
            </h2>
            <div class="playoff-container">
                <div class="playoff-grid">
                    <div class="playoff-round">
                        <div class="round-title">1/4 –§–ò–ù–ê–õ–ê</div>
                        <div class="matchup" id="quarter1">
                            <div class="team-match">
                                <span>–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏ üèí</span>
                                <span class="match-score">3</span>
                            </div>
                            <div class="team-match">
                                <span>–ò—Å–∫—Ä–∞ ‚ö°</span>
                                <span class="match-score">1</span>
                            </div>
                        </div>
                        <div class="matchup" id="quarter2">
                            <div class="team-match">
                                <span>–°—Ç–∞–ª—å–Ω—ã–µ –¢–∏–≥—Ä—ã üêØ</span>
                                <span class="match-score">2</span>
                            </div>
                            <div class="team-match">
                                <span>–ì—Ä–∞–Ω–∏—Ç ü™®</span>
                                <span class="match-score">3</span>
                            </div>
                        </div>
                    </div>
                    <div class="playoff-round">
                        <div class="round-title">1/2 –§–ò–ù–ê–õ–ê</div>
                        <div class="matchup" id="semi1">
                            <div class="team-match">
                                <span>–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏ üèí</span>
                                <span class="match-score">3</span>
                            </div>
                            <div class="team-match">
                                <span>–ì—Ä–∞–Ω–∏—Ç ü™®</span>
                                <span class="match-score">2</span>
                            </div>
                        </div>
                        <div class="matchup" id="semi2">
                            <div class="team-match">
                                <span>–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞ üöó</span>
                                <span class="match-score">4</span>
                            </div>
                            <div class="team-match">
                                <span>–°–µ–≤–µ—Ä–Ω—ã–π –í–µ—Ç–µ—Ä üå¨Ô∏è</span>
                                <span class="match-score">1</span>
                            </div>
                        </div>
                    </div>
                    <div class="playoff-round">
                        <div class="round-title">–§–ò–ù–ê–õ</div>
                        <div class="matchup" id="final">
                            <div class="team-match">
                                <span>–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏ üèí</span>
                                <span class="match-score">4</span>
                            </div>
                            <div class="team-match">
                                <span>–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞ üöó</span>
                                <span class="match-score">2</span>
                            </div>
                        </div>
                    </div>
                    <div class="cup-container">
                        <div class="cup"></div>
                        <div class="cup-name">–ö—É–±–æ–∫ –•–æ–ª–æ–¥–Ω–æ–≥–æ –ü—É—Ç–∏</div>
                        <div style="margin-top: 10px; color: #aaa; text-align: center; font-size: 14px;">
                            –ß–µ–º–ø–∏–æ–Ω —Å–µ–∑–æ–Ω–∞ 2024
                        </div>
                        <div style="margin-top: 5px; color: var(--red); font-weight: bold; font-size: 18px;">
                            –õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <section class="section" id="stats">
            <h2 class="section-title">
                <i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </h2>
            <div class="stats-grid">
                <div class="stats-card">
                    <h3 class="stats-title"><i class="fas fa-bullseye"></i> –ë–æ–º–±–∞—Ä–¥–∏—Ä—ã</h3>
                    <div id="scorersList">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                <div class="stats-card">
                    <h3 class="stats-title"><i class="fas fa-shield-alt"></i> –í—Ä–∞—Ç–∞—Ä–∏</h3>
                    <div id="goaliesList">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                <div class="stats-card">
                    <h3 class="stats-title"><i class="fas fa-exclamation-triangle"></i> –®—Ç—Ä–∞—Ñ—ã</h3>
                    <div id="penaltiesList">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
        </section>
        
        <!-- –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ -->
        <section class="section" id="admin">
            <h2 class="section-title">
                <i class="fas fa-cog"></i> –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
            </h2>
            
            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div class="admin-section" id="adminLogin">
                <div style="max-width: 500px; margin: 0 auto;">
                    <div class="form-group">
                        <label for="adminPassword"><i class="fas fa-key"></i> –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
                        <input type="password" id="adminPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞">
                    </div>
                    <div id="loginMessage" class="message"></div>
                    <button class="btn btn-blue" onclick="adminLogin()" style="width: 100%;">
                        <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
                    </button>
                    <div style="margin-top: 30px; padding: 20px; background: rgba(255,0,60,0.1); border-radius: 10px;">
                        <div style="color: var(--red); font-weight: bold; margin-bottom: 10px;">
                            <i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
                        </div>
                        <div style="color: #aaa; font-size: 14px; line-height: 1.6;">
                            <p><strong>–ü–∞—Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:</strong> admin123</p>
                            <p>–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤—ã —Å–º–æ–∂–µ—Ç–µ:</p>
                            <ul style="margin: 10px 0 10px 20px;">
                                <li>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –∏—Ö –æ—á–∫–∏</li>
                                <li>–î–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –º–∞—Ç—á–∏</li>
                                <li>–°—Ç–∞–≤–∏—Ç—å –∏—Ç–æ–≥–æ–≤—ã–µ —Å—á–µ—Ç–∞</li>
                                <li>–£–ø—Ä–∞–≤–ª—è—Ç—å –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏</li>
                                <li>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –∏ –º–µ–¥–∏–∞</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∞ -->
            <div class="admin-section" id="adminPanel" style="display: none;">
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="teams" onclick="switchAdminTab('teams')">
                        <i class="fas fa-users"></i> –ö–æ–º–∞–Ω–¥—ã
                    </button>
                    <button class="admin-tab" data-tab="matches" onclick="switchAdminTab('matches')">
                        <i class="fas fa-hockey-puck"></i> –ú–∞—Ç—á–∏
                    </button>
                    <button class="admin-tab" data-tab="playoff-admin" onclick="switchAdminTab('playoff-admin')">
                        <i class="fas fa-trophy"></i> –ü–ª–µ–π-–æ—Ñ—Ñ
                    </button>
                    <button class="admin-tab" data-tab="content" onclick="switchAdminTab('content')">
                        <i class="fas fa-newspaper"></i> –ö–æ–Ω—Ç–µ–Ω—Ç
                    </button>
                    <button class="admin-tab" data-tab="settings" onclick="switchAdminTab('settings')">
                        <i class="fas fa-sliders-h"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                </div>
                
                <div id="adminMessage" class="message"></div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏ -->
                <div id="teamsTab" class="admin-content active">
                    <h3 style="color: var(--blue); margin-bottom: 20px;"><i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥</h3>
                    <div class="form-grid" id="teamsForm">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                    <div style="display: flex; gap: 15px; margin-top: 20px;">
                        <button class="btn btn-green" onclick="addTeam()">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
                        </button>
                        <button class="btn" onclick="updateTeams()">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        </button>
                    </div>
                </div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞–º–∏ -->
                <div id="matchesTab" class="admin-content">
                    <h3 style="color: var(--blue); margin-bottom: 20px;"><i class="fas fa-hockey-puck"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞–º–∏</h3>
                    <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                        <button class="btn" onclick="showAddMatchModal()">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á
                        </button>
                        <button class="btn btn-blue" onclick="simulateAllMatches()">
                            <i class="fas fa-dice"></i> –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–∞—Ç—á–∏
                        </button>
                        <button class="btn" onclick="generateRegularSeason()">
                            <i class="fas fa-redo"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–∫—É
                        </button>
                    </div>
                    <div id="matchesList">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–π-–æ—Ñ—Ñ -->
                <div id="playoff-adminTab" class="admin-content">
                    <h3 style="color: var(--blue); margin-bottom: 20px;"><i class="fas fa-trophy"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–π-–æ—Ñ—Ñ</h3>
                    <div id="playoffAdminContent">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º -->
                <div id="contentTab" class="admin-content">
                    <h3 style="color: var(--blue); margin-bottom: 20px;"><i class="fas fa-newspaper"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∞–π—Ç–∞:</label>
                            <input type="text" id="siteTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∞–π—Ç–∞">
                        </div>
                        <div class="form-group">
                            <label>–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∞–π—Ç–∞:</label>
                            <textarea id="siteSubtitleInput" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∞–π—Ç–∞"></textarea>
                        </div>
                        <div class="form-group">
                            <label>–õ–æ–≥–æ—Ç–∏–ø –ª–∏–≥–∏ (—ç–º–æ–¥–∑–∏):</label>
                            <input type="text" id="leagueLogo" placeholder="üèí">
                        </div>
                        <div class="form-group">
                            <label>–¶–≤–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞:</label>
                            <input type="color" id="accentColor" value="#ff003c">
                        </div>
                    </div>
                    <div style="display: flex; gap: 15px; margin-top: 20px;">
                        <button class="btn" onclick="updateContent()">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
                        </button>
                    </div>
                </div>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div id="settingsTab" class="admin-content">
                    <h3 style="color: var(--blue); margin-bottom: 20px;"><i class="fas fa-sliders-h"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
                            <input type="password" id="newAdminPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å">
                        </div>
                        <div class="form-group">
                            <label>–û—á–∫–∏ –∑–∞ –ø–æ–±–µ–¥—É:</label>
                            <input type="number" id="pointsForWin" value="2" min="1" max="10">
                        </div>
                        <div class="form-group">
                            <label>–û—á–∫–∏ –∑–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ:</label>
                            <input type="number" id="pointsForLoss" value="0" min="0" max="5">
                        </div>
                    </div>
                    <div style="display: flex; gap: 15px; margin-top: 20px;">
                        <button class="btn" onclick="updateSettings()">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                        </button>
                        <button class="btn btn-blue" onclick="exportData()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button class="btn" onclick="importData()" style="background: #9b59b6;">
                            <i class="fas fa-upload"></i> –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                    </div>
                    <div style="margin-top: 30px; padding: 20px; background: rgba(255,0,60,0.1); border-radius: 10px;">
                        <h4 style="color: var(--red); margin-bottom: 10px;"><i class="fas fa-exclamation-triangle"></i> –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h4>
                        <button class="btn" onclick="resetData()" style="background: #e74c3c;">
                            <i class="fas fa-trash"></i> –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>
                
                <div style="margin-top: 30px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="color: #aaa; font-size: 14px;">
                        <i class="fas fa-sync-alt"></i> –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    </div>
                    <button class="btn" onclick="adminLogout()" style="background: #7f8c8d;">
                        <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
                    </button>
                </div>
            </div>
        </section>
        
        <!-- –ò–ù–§–û –ü–ê–ù–ï–õ–¨ -->
        <div class="info-panel">
            <p class="info-text">
                <i class="fas fa-sync-alt pulse"></i> <span id="syncStatus">–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã</span>
            </p>
            <p class="info-text">
                <i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π —Å –¥—Ä—É–∑—å—è–º–∏: <span id="currentUrl"></span>
            </p>
            <div class="sync-status" id="lastSyncTime">
                <i class="fas fa-clock"></i> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ —á—Ç–æ
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–∞ -->
    <div class="modal" id="addMatchModal">
        <div class="modal-content">
            <h3 style="color: var(--red); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º–∞—Ç—á
            </h3>
            <div class="form-group">
                <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                <input type="date" id="matchDate">
            </div>
            <div class="form-group">
                <label>–í—Ä–µ–º—è –º–∞—Ç—á–∞:</label>
                <input type="time" id="matchTime" value="19:00">
            </div>
            <div class="form-group">
                <label>–ö–æ–º–∞–Ω–¥–∞ 1:</label>
                <select id="matchTeam1">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>
                </select>
            </div>
            <div class="form-group">
                <label>–ö–æ–º–∞–Ω–¥–∞ 2:</label>
                <select id="matchTeam2">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>
                </select>
            </div>
            <div class="form-group">
                <label>–°—Ç–∞—Ç—É—Å:</label>
                <select id="matchStatus">
                    <option value="scheduled">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</option>
                    <option value="finished">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
                </select>
            </div>
            <div id="scoreFields" style="display: none;">
                <div class="form-group">
                    <label>–°—á–µ—Ç –∫–æ–º–∞–Ω–¥—ã 1:</label>
                    <input type="number" id="matchScore1" min="0" value="0">
                </div>
                <div class="form-group">
                    <label>–°—á–µ—Ç –∫–æ–º–∞–Ω–¥—ã 2:</label>
                    <input type="number" id="matchScore2" min="0" value="0">
                </div>
            </div>
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button class="btn btn-green" onclick="saveNewMatch()" style="flex: 1;">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button class="btn" onclick="closeModal('addMatchModal')" style="flex: 1;">
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–∞ -->
    <div class="modal" id="editMatchModal">
        <div class="modal-content">
            <h3 style="color: var(--blue); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—á
            </h3>
            <input type="hidden" id="editMatchId">
            <div class="form-group">
                <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                <input type="date" id="editMatchDate">
            </div>
            <div class="form-group">
                <label>–í—Ä–µ–º—è –º–∞—Ç—á–∞:</label>
                <input type="time" id="editMatchTime">
            </div>
            <div class="form-group">
                <label>–°—Ç–∞—Ç—É—Å:</label>
                <select id="editMatchStatus">
                    <option value="scheduled">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</option>
                    <option value="finished">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
                </select>
            </div>
            <div id="editScoreFields">
                <div class="form-group">
                    <label>–°—á–µ—Ç –∫–æ–º–∞–Ω–¥—ã 1:</label>
                    <input type="number" id="editMatchScore1" min="0">
                </div>
                <div class="form-group">
                    <label>–°—á–µ—Ç –∫–æ–º–∞–Ω–¥—ã 2:</label>
                    <input type="number" id="editMatchScore2" min="0">
                </div>
            </div>
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button class="btn btn-green" onclick="updateMatch()" style="flex: 1;">
                    <i class="fas fa-save"></i> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
                <button class="btn" onclick="closeModal('editMatchModal')" style="flex: 1;">
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                </button>
                <button class="btn" onclick="deleteMatch()" style="background: #e74c3c; flex: 1;">
                    <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                </button>
            </div>
        </div>
    </div>
    
    <!-- –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö -->
    <input type="file" id="importFile" style="display: none;" accept=".json" onchange="handleImportFile(event)">

    <script>
        // ============================================
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
        // ============================================
        const ADMIN_PASSWORD = "admin123";
        const STORAGE_KEY = "dhl_hockey_advanced_data";
        const DEFAULT_POINTS_WIN = 2;
        const DEFAULT_POINTS_LOSS = 0;
        
        // ============================================
        // –î–ê–ù–ù–´–ï –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ
        // ============================================
        const defaultData = {
            teams: [
                { id: 1, name: "–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏", short: "–õ–í", logo: "üèí", points: 32, games: 10, wins: 10, losses: 0, form: ["W", "W", "W", "W", "W"] },
                { id: 2, name: "–°—Ç–∞–ª—å–Ω—ã–µ –¢–∏–≥—Ä—ã", short: "–°–¢", logo: "üêØ", points: 28, games: 10, wins: 8, losses: 2, form: ["W", "L", "W", "W", "W"] },
                { id: 3, name: "–°–µ–≤–µ—Ä–Ω—ã–π –í–µ—Ç–µ—Ä", short: "–°–í", logo: "üå¨Ô∏è", points: 25, games: 10, wins: 7, losses: 3, form: ["W", "W", "L", "W", "W"] },
                { id: 4, name: "–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞", short: "–ö–ú", logo: "üöó", points: 24, games: 10, wins: 7, losses: 3, form: ["L", "W", "W", "W", "L"] },
                { id: 5, name: "–ú–µ—Ç–µ–æ—Ä", short: "–ú–¢", logo: "‚òÑÔ∏è", points: 20, games: 10, wins: 6, losses: 4, form: ["W", "L", "W", "L", "W"] },
                { id: 6, name: "–®—Ç–æ—Ä–º", short: "–®–¢", logo: "‚õàÔ∏è", points: 18, games: 10, wins: 5, losses: 5, form: ["L", "W", "L", "W", "L"] },
                { id: 7, name: "–ì—Ä–∞–Ω–∏—Ç", short: "–ì–†", logo: "ü™®", points: 15, games: 10, wins: 4, losses: 6, form: ["W", "L", "L", "W", "L"] },
                { id: 8, name: "–ò—Å–∫—Ä–∞", short: "–ò–°", logo: "‚ö°", points: 14, games: 10, wins: 4, losses: 6, form: ["L", "W", "L", "L", "W"] },
                { id: 9, name: "–¢–∏—Ç–∞–Ω—ã", short: "–¢–¢", logo: "ü¶æ", points: 12, games: 10, wins: 3, losses: 7, form: ["L", "L", "W", "L", "L"] },
                { id: 10, name: "–°–æ–∫–æ–ª", short: "–°–ö", logo: "ü¶Ö", points: 10, games: 10, wins: 2, losses: 8, form: ["L", "L", "L", "W", "L"] },
                { id: 11, name: "–ê—Ç–ª–∞–Ω—Ç", short: "–ê–¢", logo: "üåä", points: 8, games: 10, wins: 2, losses: 8, form: ["L", "W", "L", "L", "L"] },
                { id: 12, name: "–í–∏—Ç—è–∑—å", short: "–í–¢", logo: "‚öîÔ∏è", points: 6, games: 10, wins: 1, losses: 9, form: ["L", "L", "L", "L", "W"] }
            ],
            
            matches: [],
            
            playoff: {
                quarter1: { team1: "–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏", team2: "–ò—Å–∫—Ä–∞", score1: 3, score2: 1 },
                quarter2: { team1: "–°—Ç–∞–ª—å–Ω—ã–µ –¢–∏–≥—Ä—ã", team2: "–ì—Ä–∞–Ω–∏—Ç", score1: 2, score2: 3 },
                semi1: { team1: "–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏", team2: "–ì—Ä–∞–Ω–∏—Ç", score1: 3, score2: 2 },
                semi2: { team1: "–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞", team2: "–°–µ–≤–µ—Ä–Ω—ã–π –í–µ—Ç–µ—Ä", score1: 4, score2: 1 },
                final: { team1: "–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏", team2: "–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞", score1: 4, score2: 2 }
            },
            
            stats: {
                scorers: [
                    { player: "–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤", team: "–°—Ç–∞–ª—å–Ω—ã–µ –¢–∏–≥—Ä—ã", points: 45, goals: 25, assists: 20 },
                    { player: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤", team: "–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏", points: 42, goals: 22, assists: 20 },
                    { player: "–°–µ—Ä–≥–µ–π –ö–æ–∑–ª–æ–≤", team: "–°–µ–≤–µ—Ä–Ω—ã–π –í–µ—Ç–µ—Ä", points: 38, goals: 18, assists: 20 },
                    { player: "–î–º–∏—Ç—Ä–∏–π –û—Ä–ª–æ–≤", team: "–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞", points: 36, goals: 15, assists: 21 },
                    { player: "–ê–Ω–¥—Ä–µ–π –í–æ–ª–∫–æ–≤", team: "–ú–µ—Ç–µ–æ—Ä", points: 34, goals: 17, assists: 17 }
                ],
                goalies: [
                    { player: "–ü–∞–≤–µ–ª –ë–µ–ª–æ–≤", team: "–õ–µ–¥—è–Ω—ã–µ –í–æ–ª–∫–∏", savePercent: 94.2, games: 10, shutouts: 3 },
                    { player: "–ú–∞–∫—Å–∏–º –°–æ–∫–æ–ª–æ–≤", team: "–°—Ç–∞–ª—å–Ω—ã–µ –¢–∏–≥—Ä—ã", savePercent: 93.8, games: 10, shutouts: 2 },
                    { player: "–ê—Ä—Ç–µ–º –ò–≤–∞–Ω–æ–≤", team: "–°–µ–≤–µ—Ä–Ω—ã–π –í–µ—Ç–µ—Ä", savePercent: 93.5, games: 10, shutouts: 2 },
                    { player: "–ù–∏–∫–∏—Ç–∞ –ö—É–∑–Ω–µ—Ü–æ–≤", team: "–ö—Ä–∞—Å–Ω–∞—è –ú–∞—à–∏–Ω–∞", savePercent: 93.1, games: 10, shutouts: 1 },
                    { player: "–í–ª–∞–¥–∏–º–∏—Ä –ú–æ—Ä–æ–∑–æ–≤", team: "–ú–µ—Ç–µ–æ—Ä", savePercent: 92.7, games: 10, shutouts: 1 }
                ],
                penalties: [
                    { player: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ì—Ä–æ–º–æ–≤", team: "–¢–∏—Ç–∞–Ω—ã", minutes: 85, fights: 3, games: 10 },
                    { player: "–ò–≥–æ—Ä—å –ñ–µ–ª–µ–∑–Ω–æ–≤", team: "–ì—Ä–∞–Ω–∏—Ç", minutes: 72, fights: 2, games: 10 },
                    { player: "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ë—É—Ä–æ–≤", team: "–®—Ç–æ—Ä–º", minutes: 68, fights: 1, games: 10 },
                    { player: "–†–æ–º–∞–Ω –°—Ç–∞–ª—å–Ω–æ–π", team: "–í–∏—Ç—è–∑—å", minutes: 65, fights: 2, games: 10 },
                    { player: "–í–∏–∫—Ç–æ—Ä –ö–∞–º–µ–Ω–µ–≤", team: "–°–æ–∫–æ–ª", minutes: 58, fights: 1, games: 10 }
                ]
            },
            
            content: {
                siteTitle: "–î–•–õ –•–û–ö–ö–ï–ô –õ–ò–ì–ê",
                siteSubtitle: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ö–æ–∫–∫–µ–π –±—É–¥—É—â–µ–≥–æ ‚Ä¢ –°–µ–∑–æ–Ω 2024 ‚Ä¢ –ö—É–±–æ–∫ –•–æ–ª–æ–¥–Ω–æ–≥–æ –ü—É—Ç–∏",
                leagueLogo: "üèí",
                accentColor: "#ff003c"
            },
            
            settings: {
                adminPassword: ADMIN_PASSWORD,
                pointsForWin: DEFAULT_POINTS_WIN,
                pointsForLoss: DEFAULT_POINTS_LOSS,
                lastUpdated: new Date().toISOString(),
                adminLoggedIn: false
            }
        };
        
        let appData = JSON.parse(JSON.stringify(defaultData));
        
        // ============================================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================================
        function init() {
            loadData();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–µ–∑–æ–Ω –µ—Å–ª–∏ –º–∞—Ç—á–µ–π –Ω–µ—Ç
            if (appData.matches.length === 0) {
                generateRegularSeason();
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll(".nav-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    switchSection(this.getAttribute("data-section"));
                });
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º—ã –º–∞—Ç—á–∞
            document.getElementById("matchStatus").addEventListener("change", function() {
                document.getElementById("scoreFields").style.display = 
                    this.value === "finished" ? "block" : "none";
            });
            
            document.getElementById("editMatchStatus").addEventListener("change", function() {
                document.getElementById("editScoreFields").style.display = 
                    this.value === "finished" ? "block" : "none";
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateAllSections();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π URL
            document.getElementById("currentUrl").textContent = window.location.href;
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(checkForUpdates, 30000);
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            setInterval(saveData, 10000);
            
            console.log("–î–•–õ –•–æ–∫–∫–µ–π –õ–∏–≥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!");
        }
        
        // ============================================
        // –†–ê–ë–û–¢–ê –° –î–ê–ù–ù–´–ú–ò
        // ============================================
        function loadData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    appData = JSON.parse(saved);
                    // –°–æ–∑–¥–∞–µ–º –º–∞—Ç—á–∏ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                    if (!appData.matches || appData.matches.length === 0) {
                        generateRegularSeason();
                    }
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", e);
                    appData = JSON.parse(JSON.stringify(defaultData));
                    generateRegularSeason();
                }
            } else {
                generateRegularSeason();
            }
        }
        
        function saveData() {
            appData.settings.lastUpdated = new Date().toISOString();
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
            updateSyncStatus();
        }
        
        function resetData() {
            if (confirm("–í–ù–ò–ú–ê–ù–ò–ï! –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.")) {
                appData = JSON.parse(JSON.stringify(defaultData));
                generateRegularSeason();
                saveData();
                showMessage("adminMessage", "‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–±—Ä–æ—à–µ–Ω—ã –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º!", "success");
                updateAllSections();
            }
        }
        
        // ============================================
        // –ì–ï–ù–ï–†–ê–¶–ò–Ø –†–ï–ì–£–õ–Ø–†–ù–û–ì–û –°–ï–ó–û–ù–ê
        // ============================================
        function generateRegularSeason() {
            const matches = [];
            const teams = appData.teams;
            let matchId = 1;
            
            // –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –∏–≥—Ä–∞–µ—Ç —Å –∫–∞–∂–¥–æ–π –¥–≤–∞ —Ä–∞–∑–∞ (–¥–æ–º–∞ –∏ –≤ –≥–æ—Å—Ç—è—Ö)
            for (let i = 0; i < teams.length; i++) {
                for (let j = i + 1; j < teams.length; j++) {
                    // –ü–µ—Ä–≤—ã–π –º–∞—Ç—á
                    const date1 = new Date(2024, 10, 15 + matchId);
                    matches.push({
                        id: matchId++,
                        date: `${date1.getDate()}.${date1.getMonth() + 1}.${date1.getFullYear()}`,
                        time: "19:00",
                        team1: teams[i].name,
                        team2: teams[j].name,
                        score1: null,
                        score2: null,
                        status: "scheduled"
                    });
                    
                    // –í—Ç–æ—Ä–æ–π –º–∞—Ç—á (–æ—Ç–≤–µ—Ç–Ω—ã–π)
                    const date2 = new Date(2024, 11, 15 + matchId);
                    matches.push({
                        id: matchId++,
                        date: `${date2.getDate()}.${date2.getMonth() + 1}.${date2.getFullYear()}`,
                        time: "20:30",
                        team1: teams[j].name,
                        team2: teams[i].name,
                        score1: null,
                        score2: null,
                        status: "scheduled"
                    });
                }
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –º–∞—Ç—á–∏ –ø–æ –¥–∞—Ç–µ
            matches.sort((a, b) => {
                const dateA = parseDate(a.date);
                const dateB = parseDate(b.date);
                return dateA - dateB;
            });
            
            appData.matches = matches;
            saveData();
            updateAllSections();
            showMessage("adminMessage", "‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–π —Å–µ–∑–æ–Ω —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!", "success");
        }
        
        function parseDate(dateStr) {
            const parts = dateStr.split('.');
            return new Date(parts[2], parts[1] - 1, parts[0]);
        }
        
        // ============================================
        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø
        // ============================================
        function updateAllSections() {
            renderStandings();
            renderCalendar();
            renderStats();
            renderAdminContent();
            updateContentDisplay();
            updateSyncStatus();
        }
        
        function renderStandings() {
            const tbody = document.getElementById("standingsBody");
            if (!tbody) return;
            
            const sortedTeams = [...appData.teams].sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                return b.wins - a.wins;
            });
            
            let html = "";
            sortedTeams.forEach((team, index) => {
                const isPlayoff = index < 8;
                const formHTML = team.form?.map(result => 
                    `<span style="
                        display: inline-block; 
                        width: 20px; 
                        height: 20px; 
                        border-radius: 3px; 
                        text-align: center;
                        font-size: 10px;
                        font-weight: bold;
                        background: ${result === 'W' ? '#2ecc71' : '#e74c3c'};
                        color: white;
                        margin-right: 2px;
                    ">${result}</span>`
                ).join('');
                
                html += `
                    <tr class="${isPlayoff ? 'playoff' : ''}">
                        <td style="text-align: center; font-weight: bold; font-size: 18px;">
                            ${index + 1}
                        </td>
                        <td>
                            <div class="team-cell">
                                <div class="team-logo">${team.logo}</div>
                                <div>
                                    <div style="font-weight: bold;">${team.name}</div>
                                    <div style="color: #aaa; font-size: 12px;">${team.short}</div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align: center; font-weight: bold;">${team.games || 0}</td>
                        <td style="text-align: center; color: #2ecc71; font-weight: bold;">${team.wins || 0}</td>
                        <td style="text-align: center; color: #e74c3c; font-weight: bold;">${team.losses || 0}</td>
                        <td style="text-align: center;">
                            <span style="
                                background: rgba(255,0,60,0.2); 
                                color: var(--red); 
                                font-weight: bold; 
                                font-size: 20px;
                                padding: 8px 15px;
                                border-radius: 8px;
                                display: inline-block;
                                border: 2px solid rgba(255,0,60,0.3);
                            ">
                                ${team.points}
                            </span>
                        </td>
                        <td>${formHTML || ''}</td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
            document.getElementById("lastUpdated").textContent = 
                new Date(appData.settings.lastUpdated).toLocaleTimeString();
        }
        
        function renderCalendar() {
            const container = document.getElementById("calendarGrid");
            if (!container) return;
            
            const matchesByDate = {};
            appData.matches.forEach(match => {
                if (!matchesByDate[match.date]) {
                    matchesByDate[match.date] = [];
                }
                matchesByDate[match.date].push(match);
            });
            
            let html = "";
            Object.keys(matchesByDate).forEach(date => {
                const dayMatches = matchesByDate[date];
                
                html += `
                    <div class="match-day">
                        <div class="match-date">
                            <i class="far fa-calendar"></i> ${date}
                            <span style="color: #aaa; font-size: 14px;">${dayMatches.length} –º–∞—Ç—á${dayMatches.length > 1 ? '–∞' : ''}</span>
                        </div>
                `;
                
                dayMatches.forEach(match => {
                    const isFinished = match.status === "finished";
                    const score1 = isFinished ? match.score1 : "-";
                    const score2 = isFinished ? match.score2 : "-";
                    
                    html += `
                        <div class="match">
                            <div class="match-teams">
                                <div class="match-team">
                                    <div class="match-logo">${getTeamLogo(match.team1)}</div>
                                    <span>${match.team1}</span>
                                </div>
                                <span class="match-vs">VS</span>
                                <div class="match-team">
                                    <div class="match-logo">${getTeamLogo(match.team2)}</div>
                                    <span>${match.team2}</span>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div class="match-score">${score1}:${score2}</div>
                                <div style="color: ${isFinished ? '#2ecc71' : '#f1c40f'}; font-size: 12px; margin-top: 5px;">
                                    ${match.time || '19:00'}
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += `</div>`;
            });
            
            container.innerHTML = html;
        }
        
        function renderStats() {
            // –ë–æ–º–±–∞—Ä–¥–∏—Ä—ã
            const scorersList = document.getElementById("scorersList");
            if (scorersList) {
                let html = "";
                appData.stats.scorers.forEach((player, index) => {
                    html += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="
                                    width: 30px; 
                                    height: 30px; 
                                    background: rgba(255,0,60,0.2); 
                                    border-radius: 50%; 
                                    display: flex; 
                                    align-items: center; 
                                    justify-content: center;
                                    font-weight: bold;
                                    font-size: 14px;
                                ">
                                    ${index + 1}
                                </div>
                                <div>
                                    <strong>${player.player}</strong>
                                    <div style="color: #aaa; font-size: 12px;">${player.team}</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #ff003c; font-weight: bold; font-size: 18px;">${player.points}</div>
                                <div style="color: #aaa; font-size: 12px;">${player.goals}+${player.assists}</div>
                            </div>
                        </div>
                    `;
                });
                scorersList.innerHTML = html;
            }
            
            // –í—Ä–∞—Ç–∞—Ä–∏
            const goaliesList = document.getElementById("goaliesList");
            if (goaliesList) {
                let html = "";
                appData.stats.goalies.forEach((player, index) => {
                    html += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="
                                    width: 30px; 
                                    height: 30px; 
                                    background: rgba(0,168,255,0.2); 
                                    border-radius: 50%; 
                                    display: flex; 
                                    align-items: center; 
                                    justify-content: center;
                                    font-weight: bold;
                                    font-size: 14px;
                                ">
                                    ${index + 1}
                                </div>
                                <div>
                                    <strong>${player.player}</strong>
                                    <div style="color: #aaa; font-size: 12px;">${player.team}</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #00a8ff; font-weight: bold; font-size: 18px;">${player.savePercent}%</div>
                                <div style="color: #aaa; font-size: 12px;">${player.shutouts} "—Å—É—Ö–∞—Ä–µ–π"</div>
                            </div>
                        </div>
                    `;
                });
                goaliesList.innerHTML = html;
            }
            
            // –®—Ç—Ä–∞—Ñ—ã
            const penaltiesList = document.getElementById("penaltiesList");
            if (penaltiesList) {
                let html = "";
                appData.stats.penalties.forEach((player, index) => {
                    html += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="
                                    width: 30px; 
                                    height: 30px; 
                                    background: rgba(241,196,15,0.2); 
                                    border-radius: 50%; 
                                    display: flex; 
                                    align-items: center; 
                                    justify-content: center;
                                    font-weight: bold;
                                    font-size: 14px;
                                ">
                                    ${index + 1}
                                </div>
                                <div>
                                    <strong>${player.player}</strong>
                                    <div style="color: #aaa; font-size: 12px;">${player.team}</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #f1c40f; font-weight: bold; font-size: 18px;">${player.minutes}</div>
                                <div style="color: #aaa; font-size: 12px;">${player.fights} –¥—Ä–∞–∫</div>
                            </div>
                        </div>
                    `;
                });
                penaltiesList.innerHTML = html;
            }
        }
        
        function getTeamLogo(teamName) {
            const team = appData.teams.find(t => t.name === teamName);
            return team ? team.logo : "üèí";
        }
        
        // ============================================
        // –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨
        // ============================================
        function adminLogin() {
            const password = document.getElementById("adminPassword").value;
            const correctPassword = appData.settings.adminPassword || ADMIN_PASSWORD;
            
            if (password === correctPassword) {
                appData.settings.adminLoggedIn = true;
                document.getElementById("adminLogin").style.display = "none";
                document.getElementById("adminPanel").style.display = "block";
                showMessage("adminMessage", "‚úÖ –í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!", "success");
                renderAdminContent();
                saveData();
            } else {
                showMessage("loginMessage", "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!", "error");
            }
        }
        
        function adminLogout() {
            appData.settings.adminLoggedIn = false;
            document.getElementById("adminLogin").style.display = "block";
            document.getElementById("adminPanel").style.display = "none";
            document.getElementById("adminPassword").value = "";
            showMessage("loginMessage", "‚úÖ –í—ã –≤—ã—à–ª–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞", "success");
            saveData();
        }
        
        function switchAdminTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll(".admin-content").forEach(tab => {
                tab.classList.remove("active");
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll(".admin-tab").forEach(btn => {
                btn.classList.remove("active");
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(`${tabName}Tab`).classList.add("active");
            
            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É
            document.querySelector(`[data-tab="${tabName}"]`).classList.add("active");
        }
        
        function renderAdminContent() {
            renderTeamsForm();
            renderMatchesList();
            renderPlayoffAdmin();
            loadContentForm();
            loadSettingsForm();
        }
        
        function renderTeamsForm() {
            const container = document.getElementById("teamsForm");
            let html = "";
            
            appData.teams.forEach(team => {
                html += `
                    <div style="
                        background: rgba(42,42,42,0.5); 
                        padding: 20px; 
                        border-radius: 10px; 
                        border-left: 4px solid var(--red);
                    ">
                        <h4 style="color: var(--red); margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            ${team.logo} ${team.name}
                        </h4>
                        <div class="form-grid" style="grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));">
                            <div class="form-group">
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                                <input type="text" value="${team.name}" 
                                    onchange="updateTeamField(${team.id}, 'name', this.value)">
                            </div>
                            <div class="form-group">
                                <label>–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ:</label>
                                <input type="text" value="${team.short}" 
                                    onchange="updateTeamField(${team.id}, 'short', this.value)">
                            </div>
                            <div class="form-group">
                                <label>–õ–æ–≥–æ—Ç–∏–ø (—ç–º–æ–¥–∑–∏):</label>
                                <input type="text" value="${team.logo}" 
                                    onchange="updateTeamField(${team.id}, 'logo', this.value)">
                            </div>
                            <div class="form-group">
                                <label>–û—á–∫–∏:</label>
                                <input type="number" value="${team.points}" 
                                    onchange="updateTeamField(${team.id}, 'points', parseInt(this.value))">
                            </div>
                            <div class="form-group">
                                <label>–ü–æ–±–µ–¥—ã:</label>
                                <input type="number" value="${team.wins || 0}" 
                                    onchange="updateTeamField(${team.id}, 'wins', parseInt(this.value))">
                            </div>
                            <div class="form-group">
                                <label>–ü–æ—Ä–∞–∂–µ–Ω–∏—è:</label>
                                <input type="number" value="${team.losses || 0}" 
                                    onchange="updateTeamField(${team.id}, 'losses', parseInt(this.value))">
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateTeamField(teamId, field, value) {
            const team = appData.teams.find(t => t.id === teamId);
            if (team) {
                team[field] = value;
                saveData();
                updateAllSections();
            }
        }
        
        function addTeam() {
            const newId = Math.max(...appData.teams.map(t => t.id)) + 1;
            appData.teams.push({
                id: newId,
                name: `–ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ ${newId}`,
                short: "–ù–ö",
                logo: "üèí",
                points: 0,
                games: 0,
                wins: 0,
                losses: 0,
                form: []
            });
            saveData();
            renderAdminContent();
            showMessage("adminMessage", "‚úÖ –ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!", "success");
        }
        
        function updateTeams() {
            saveData();
            updateAllSections();
            showMessage("adminMessage", "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!", "success");
        }
        
        function renderMatchesList() {
            const container = document.getElementById("matchesList");
            let html = "";
            
            appData.matches.forEach(match => {
                html += `
                    <div style="
                        background: rgba(42,42,42,0.5); 
                        padding: 20px; 
                        border-radius: 10px; 
                        margin-bottom: 15px;
                        border-left: 4px solid ${match.status === 'finished' ? '#2ecc71' : '#f1c40f'};
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div>
                                <strong style="color: ${match.status === 'finished' ? '#2ecc71' : '#f1c40f'}">
                                    ${match.date} ${match.time}
                                </strong>
                                <div style="color: #aaa; font-size: 12px; margin-top: 5px;">
                                    ID: ${match.id}
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn" onclick="editMatch(${match.id})" style="padding: 8px 15px;">
                                    <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                                <button class="btn" onclick="simulateMatch(${match.id})" style="padding: 8px 15px; background: #9b59b6;">
                                    <i class="fas fa-dice"></i> –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 24px;">${getTeamLogo(match.team1)}</div>
                                    <div>${match.team1}</div>
                                </div>
                                <div style="
                                    font-size: 24px; 
                                    font-weight: bold; 
                                    color: ${match.status === 'finished' ? 'var(--red)' : '#aaa'};
                                    padding: 0 20px;
                                ">
                                    ${match.status === 'finished' ? `${match.score1} : ${match.score2}` : 'vs'}
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 24px;">${getTeamLogo(match.team2)}</div>
                                    <div>${match.team2}</div>
                                </div>
                            </div>
                            <div style="
                                background: ${match.status === 'finished' ? 'rgba(46,204,113,0.2)' : 'rgba(241,196,15,0.2)'};
                                color: ${match.status === 'finished' ? '#2ecc71' : '#f1c40f'};
                                padding: 8px 15px;
                                border-radius: 8px;
                                font-weight: bold;
                            ">
                                ${match.status === 'finished' ? '–ó–∞–≤–µ—Ä—à–µ–Ω' : '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω'}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // ============================================
        // –ú–ê–¢–ß–ò
        // ============================================
        function showAddMatchModal() {
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–∫–∏ –∫–æ–º–∞–Ω–¥
            const team1Select = document.getElementById("matchTeam1");
            const team2Select = document.getElementById("matchTeam2");
            
            team1Select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>';
            team2Select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>';
            
            appData.teams.forEach(team => {
                team1Select.innerHTML += `<option value="${team.name}">${team.name}</option>`;
                team2Select.innerHTML += `<option value="${team.name}">${team.name}</option>`;
            });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
            const today = new Date().toISOString().split('T')[0];
            document.getElementById("matchDate").value = today;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById("addMatchModal").classList.add("active");
        }
        
        function saveNewMatch() {
            const date = document.getElementById("matchDate").value;
            const time = document.getElementById("matchTime").value;
            const team1 = document.getElementById("matchTeam1").value;
            const team2 = document.getElementById("matchTeam2").value;
            const status = document.getElementById("matchStatus").value;
            
            if (!team1 || !team2) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±–µ –∫–æ–º–∞–Ω–¥—ã");
                return;
            }
            
            if (team1 === team2) {
                alert("–ö–æ–º–∞–Ω–¥–∞ –Ω–µ –º–æ–∂–µ—Ç –∏–≥—Ä–∞—Ç—å —Å–∞–º–∞ —Å —Å–æ–±–æ–π");
                return;
            }
            
            const newId = appData.matches.length > 0 ? 
                Math.max(...appData.matches.map(m => m.id)) + 1 : 1;
            
            const match = {
                id: newId,
                date: formatDate(date),
                time: time,
                team1: team1,
                team2: team2,
                score1: status === "finished" ? parseInt(document.getElementById("matchScore1").value) || 0 : null,
                score2: status === "finished" ? parseInt(document.getElementById("matchScore2").value) || 0 : null,
                status: status
            };
            
            appData.matches.push(match);
            appData.matches.sort((a, b) => parseDate(a.date) - parseDate(b.date));
            
            saveData();
            updateAllSections();
            closeModal("addMatchModal");
            showMessage("adminMessage", "‚úÖ –ù–æ–≤—ã–π –º–∞—Ç—á –¥–æ–±–∞–≤–ª–µ–Ω!", "success");
        }
        
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return `${date.getDate()}.${date.getMonth() + 1}.${date.getFullYear()}`;
        }
        
        function editMatch(matchId) {
            const match = appData.matches.find(m => m.id === matchId);
            if (!match) return;
            
            document.getElementById("editMatchId").value = matchId;
            document.getElementById("editMatchDate").value = reverseFormatDate(match.date);
            document.getElementById("editMatchTime").value = match.time || "19:00";
            document.getElementById("editMatchStatus").value = match.status;
            document.getElementById("editMatchScore1").value = match.score1 || 0;
            document.getElementById("editMatchScore2").value = match.score2 || 0;
            
            document.getElementById("editScoreFields").style.display = 
                match.status === "finished" ? "block" : "none";
            
            document.getElementById("editMatchModal").classList.add("active");
        }
        
        function reverseFormatDate(dateStr) {
            const parts = dateStr.split('.');
            return `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;
        }
        
        function updateMatch() {
            const matchId = parseInt(document.getElementById("editMatchId").value);
            const match = appData.matches.find(m => m.id === matchId);
            
            if (match) {
                const oldStatus = match.status;
                const oldScore1 = match.score1;
                const oldScore2 = match.score2;
                
                match.date = formatDate(document.getElementById("editMatchDate").value);
                match.time = document.getElementById("editMatchTime").value;
                match.status = document.getElementById("editMatchStatus").value;
                
                if (match.status === "finished") {
                    match.score1 = parseInt(document.getElementById("editMatchScore1").value) || 0;
                    match.score2 = parseInt(document.getElementById("editMatchScore2").value) || 0;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–º–∞–Ω–¥
                    updateTeamStatsAfterMatch(match.team1, match.team2, match.score1, match.score2, oldStatus, oldScore1, oldScore2);
                } else {
                    match.score1 = null;
                    match.score2 = null;
                    
                    // –£–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –µ—Å–ª–∏ –º–∞—Ç—á —Å–Ω–æ–≤–∞ —Å—Ç–∞–ª –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
                    if (oldStatus === "finished") {
                        revertTeamStatsAfterMatch(match.team1, match.team2, oldScore1, oldScore2);
                    }
                }
                
                saveData();
                updateAllSections();
                closeModal("editMatchModal");
                showMessage("adminMessage", "‚úÖ –ú–∞—Ç—á –æ–±–Ω–æ–≤–ª–µ–Ω!", "success");
            }
        }
        
        function deleteMatch() {
            const matchId = parseInt(document.getElementById("editMatchId").value);
            const match = appData.matches.find(m => m.id === matchId);
            
            if (match && confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–∞—Ç—á?")) {
                if (match.status === "finished") {
                    revertTeamStatsAfterMatch(match.team1, match.team2, match.score1, match.score2);
                }
                
                appData.matches = appData.matches.filter(m => m.id !== matchId);
                saveData();
                updateAllSections();
                closeModal("editMatchModal");
                showMessage("adminMessage", "‚úÖ –ú–∞—Ç—á —É–¥–∞–ª–µ–Ω!", "success");
            }
        }
        
        function simulateMatch(matchId) {
            const match = appData.matches.find(m => m.id === matchId);
            if (!match) return;
            
            const oldStatus = match.status;
            const oldScore1 = match.score1;
            const oldScore2 = match.score2;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Å—á–µ—Ç
            match.score1 = Math.floor(Math.random() * 6);
            match.score2 = Math.floor(Math.random() * 6);
            match.status = "finished";
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–º–∞–Ω–¥
            if (oldStatus === "finished") {
                revertTeamStatsAfterMatch(match.team1, match.team2, oldScore1, oldScore2);
            }
            updateTeamStatsAfterMatch(match.team1, match.team2, match.score1, match.score2);
            
            saveData();
            updateAllSections();
            showMessage("adminMessage", `‚úÖ –ú–∞—Ç—á —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω: ${match.score1}:${match.score2}`, "success");
        }
        
        function simulateAllMatches() {
            if (!confirm("–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ç—á–∏?")) return;
            
            appData.matches.forEach(match => {
                if (match.status === "scheduled") {
                    match.score1 = Math.floor(Math.random() * 6);
                    match.score2 = Math.floor(Math.random() * 6);
                    match.status = "finished";
                    
                    updateTeamStatsAfterMatch(match.team1, match.team2, match.score1, match.score2);
                }
            });
            
            saveData();
            updateAllSections();
            showMessage("adminMessage", "‚úÖ –í—Å–µ –º–∞—Ç—á–∏ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω—ã!", "success");
        }
        
        function updateTeamStatsAfterMatch(team1Name, team2Name, score1, score2, oldStatus = null, oldScore1 = null, oldScore2 = null) {
            // –ï—Å–ª–∏ –±—ã–ª–∏ —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã - —Å–Ω–∞—á–∞–ª–∞ —É–±–∏—Ä–∞–µ–º –∏—Ö
            if (oldStatus === "finished") {
                revertTeamStatsAfterMatch(team1Name, team2Name, oldScore1, oldScore2);
            }
            
            const team1 = appData.teams.find(t => t.name === team1Name);
            const team2 = appData.teams.find(t => t.name === team2Name);
            
            if (!team1 || !team2) return;
            
            const pointsForWin = appData.settings.pointsForWin || DEFAULT_POINTS_WIN;
            const pointsForLoss = appData.settings.pointsForLoss || DEFAULT_POINTS_LOSS;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            team1.games = (team1.games || 0) + 1;
            team2.games = (team2.games || 0) + 1;
            
            if (score1 > score2) {
                // –ü–æ–±–µ–¥–∞ –ø–µ—Ä–≤–æ–π –∫–æ–º–∞–Ω–¥—ã
                team1.wins = (team1.wins || 0) + 1;
                team2.losses = (team2.losses || 0) + 1;
                team1.points += pointsForWin;
                team2.points += pointsForLoss;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–æ—Ä–º—É
                updateTeamForm(team1, 'W');
                updateTeamForm(team2, 'L');
            } else if (score1 < score2) {
                // –ü–æ–±–µ–¥–∞ –≤—Ç–æ—Ä–æ–π –∫–æ–º–∞–Ω–¥—ã
                team1.losses = (team1.losses || 0) + 1;
                team2.wins = (team2.wins || 0) + 1;
                team1.points += pointsForLoss;
                team2.points += pointsForWin;
                
                updateTeamForm(team1, 'L');
                updateTeamForm(team2, 'W');
            } else {
                // –ù–∏—á—å—è (–≤ —Ö–æ–∫–∫–µ–µ –æ–±—ã—á–Ω–æ –Ω–µ—Ç –Ω–∏—á—å–∏—Ö, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
                team1.points += 1;
                team2.points += 1;
                
                updateTeamForm(team1, 'D');
                updateTeamForm(team2, 'D');
            }
        }
        
        function revertTeamStatsAfterMatch(team1Name, team2Name, score1, score2) {
            const team1 = appData.teams.find(t => t.name === team1Name);
            const team2 = appData.teams.find(t => t.name === team2Name);
            
            if (!team1 || !team2) return;
            
            const pointsForWin = appData.settings.pointsForWin || DEFAULT_POINTS_WIN;
            const pointsForLoss = appData.settings.pointsForLoss || DEFAULT_POINTS_LOSS;
            
            // –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            team1.games = Math.max(0, (team1.games || 0) - 1);
            team2.games = Math.max(0, (team2.games || 0) - 1);
            
            if (score1 > score2) {
                team1.wins = Math.max(0, (team1.wins || 0) - 1);
                team2.losses = Math.max(0, (team2.losses || 0) - 1);
                team1.points = Math.max(0, team1.points - pointsForWin);
                team2.points = Math.max(0, team2.points - pointsForLoss);
            } else if (score1 < score2) {
                team1.losses = Math.max(0, (team1.losses || 0) - 1);
                team2.wins = Math.max(0, (team2.wins || 0) - 1);
                team1.points = Math.max(0, team1.points - pointsForLoss);
                team2.points = Math.max(0, team2.points - pointsForWin);
            } else {
                team1.points = Math.max(0, team1.points - 1);
                team2.points = Math.max(0, team2.points - 1);
            }
        }
        
        function updateTeamForm(team, result) {
            if (!team.form) team.form = [];
            team.form.unshift(result);
            if (team.form.length > 5) {
                team.form = team.form.slice(0, 5);
            }
        }
        
        // ============================================
        // –£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–û–ù–¢–ï–ù–¢–û–ú
        // ============================================
        function loadContentForm() {
            document.getElementById("siteTitle").value = appData.content.siteTitle;
            document.getElementById("siteSubtitleInput").value = appData.content.siteSubtitle;
            document.getElementById("leagueLogo").value = appData.content.leagueLogo;
            document.getElementById("accentColor").value = appData.content.accentColor;
        }
        
        function updateContent() {
            appData.content.siteTitle = document.getElementById("siteTitle").value;
            appData.content.siteSubtitle = document.getElementById("siteSubtitleInput").value;
            appData.content.leagueLogo = document.getElementById("leagueLogo").value;
            appData.content.accentColor = document.getElementById("accentColor").value;
            
            saveData();
            updateContentDisplay();
            showMessage("adminMessage", "‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω!", "success");
        }
        
        function updateContentDisplay() {
            document.querySelector(".title").textContent = appData.content.siteTitle;
            document.getElementById("siteSubtitle").textContent = appData.content.siteSubtitle;
            document.querySelector(".logo").textContent = appData.content.leagueLogo;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞
            const root = document.documentElement;
            root.style.setProperty('--red', appData.content.accentColor);
        }
        
        // ============================================
        // –ù–ê–°–¢–†–û–ô–ö–ò
        // ============================================
        function loadSettingsForm() {
            document.getElementById("newAdminPassword").value = "";
            document.getElementById("pointsForWin").value = appData.settings.pointsForWin || DEFAULT_POINTS_WIN;
            document.getElementById("pointsForLoss").value = appData.settings.pointsForLoss || DEFAULT_POINTS_LOSS;
        }
        
        function updateSettings() {
            const newPassword = document.getElementById("newAdminPassword").value;
            if (newPassword) {
                appData.settings.adminPassword = newPassword;
            }
            
            appData.settings.pointsForWin = parseInt(document.getElementById("pointsForWin").value) || DEFAULT_POINTS_WIN;
            appData.settings.pointsForLoss = parseInt(document.getElementById("pointsForLoss").value) || DEFAULT_POINTS_LOSS;
            
            saveData();
            showMessage("adminMessage", "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!", "success");
        }
        
        // ============================================
        // –ü–õ–ï–ô-–û–§–§
        // ============================================
        function renderPlayoffAdmin() {
            const container = document.getElementById("playoffAdminContent");
            let html = `
                <div class="form-grid">
                    <div class="form-group">
                        <label>–ß–µ—Ç–≤–µ—Ä—Ç—å—Ñ–∏–Ω–∞–ª 1 - –ö–æ–º–∞–Ω–¥–∞ 1:</label>
                        <input type="text" value="${appData.playoff.quarter1.team1}" 
                            onchange="updatePlayoffField('quarter1', 'team1', this.value)">
                    </div>
                    <div class="form-group">
                        <label>–ß–µ—Ç–≤–µ—Ä—Ç—å—Ñ–∏–Ω–∞–ª 1 - –ö–æ–º–∞–Ω–¥–∞ 2:</label>
                        <input type="text" value="${appData.playoff.quarter1.team2}" 
                            onchange="updatePlayoffField('quarter1', 'team2', this.value)">
                    </div>
                    <div class="form-group">
                        <label>–°—á–µ—Ç 1:</label>
                        <input type="number" value="${appData.playoff.quarter1.score1}" 
                            onchange="updatePlayoffField('quarter1', 'score1', parseInt(this.value))">
                    </div>
                    <div class="form-group">
                        <label>–°—á–µ—Ç 2:</label>
                        <input type="number" value="${appData.playoff.quarter1.score2}" 
                            onchange="updatePlayoffField('quarter1', 'score2', parseInt(this.value))">
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <button class="btn" onclick="autoFillPlayoff()">
                        <i class="fas fa-magic"></i> –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–ª–µ–π-–æ—Ñ—Ñ
                    </button>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        function updatePlayoffField(round, field, value) {
            if (appData.playoff[round]) {
                appData.playoff[round][field] = value;
                saveData();
                updatePlayoffDisplay();
            }
        }
        
        function autoFillPlayoff() {
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –ø–ª–µ–π-–æ—Ñ—Ñ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—É—Ä–Ω–∏—Ä–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
            const topTeams = [...appData.teams]
                .sort((a, b) => b.points - a.points)
                .slice(0, 8);
            
            appData.playoff.quarter1 = {
                team1: topTeams[0].name,
                team2: topTeams[7].name,
                score1: Math.floor(Math.random() * 4) + 1,
                score2: Math.floor(Math.random() * 3)
            };
            
            appData.playoff.quarter2 = {
                team1: topTeams[1].name,
                team2: topTeams[6].name,
                score1: Math.floor(Math.random() * 4) + 1,
                score2: Math.floor(Math.random() * 3)
            };
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —á–µ—Ç–≤–µ—Ä—Ç—å—Ñ–∏–Ω–∞–ª–æ–≤
            const winner1 = appData.playoff.quarter1.score1 > appData.playoff.quarter1.score2 ? 
                appData.playoff.quarter1.team1 : appData.playoff.quarter1.team2;
            const winner2 = appData.playoff.quarter2.score1 > appData.playoff.quarter2.score2 ? 
                appData.playoff.quarter2.team1 : appData.playoff.quarter2.team2;
            
            appData.playoff.semi1 = {
                team1: winner1,
                team2: winner2,
                score1: Math.floor(Math.random() * 4) + 2,
                score2: Math.floor(Math.random() * 3) + 1
            };
            
            // –í—Ç–æ—Ä—ã–µ –ø–∞—Ä—ã —á–µ—Ç–≤–µ—Ä—Ç—å—Ñ–∏–Ω–∞–ª–æ–≤
            appData.playoff.quarter3 = {
                team1: topTeams[2].name,
                team2: topTeams[5].name,
                score1: Math.floor(Math.random() * 4) + 1,
                score2: Math.floor(Math.random() * 3)
            };
            
            appData.playoff.quarter4 = {
                team1: topTeams[3].name,
                team2: topTeams[4].name,
                score1: Math.floor(Math.random() * 4) + 1,
                score2: Math.floor(Math.random() * 3)
            };
            
            const winner3 = appData.playoff.quarter3.score1 > appData.playoff.quarter3.score2 ? 
                appData.playoff.quarter3.team1 : appData.playoff.quarter3.team2;
            const winner4 = appData.playoff.quarter4.score1 > appData.playoff.quarter4.score2 ? 
                appData.playoff.quarter4.team1 : appData.playoff.quarter4.team2;
            
            appData.playoff.semi2 = {
                team1: winner3,
                team2: winner4,
                score1: Math.floor(Math.random() * 4) + 2,
                score2: Math.floor(Math.random() * 3) + 1
            };
            
            const finalWinner1 = appData.playoff.semi1.score1 > appData.playoff.semi1.score2 ? 
                appData.playoff.semi1.team1 : appData.playoff.semi1.team2;
            const finalWinner2 = appData.playoff.semi2.score1 > appData.playoff.semi2.score2 ? 
                appData.playoff.semi2.team1 : appData.playoff.semi2.team2;
            
            appData.playoff.final = {
                team1: finalWinner1,
                team2: finalWinner2,
                score1: Math.floor(Math.random() * 5) + 2,
                score2: Math.floor(Math.random() * 4) + 1
            };
            
            saveData();
            updatePlayoffDisplay();
            showMessage("adminMessage", "‚úÖ –ü–ª–µ–π-–æ—Ñ—Ñ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—É—Ä–Ω–∏—Ä–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã!", "success");
        }
        
        function updatePlayoffDisplay() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–µ–π-–æ—Ñ—Ñ
            const rounds = ['quarter1', 'quarter2', 'semi1', 'semi2', 'final'];
            rounds.forEach(round => {
                if (appData.playoff[round]) {
                    const element = document.getElementById(round);
                    if (element) {
                        const match = appData.playoff[round];
                        element.innerHTML = `
                            <div class="team-match">
                                <span>${match.team1} ${getTeamLogo(match.team1)}</span>
                                <span class="match-score">${match.score1}</span>
                            </div>
                            <div class="team-match">
                                <span>${match.team2} ${getTeamLogo(match.team2)}</span>
                                <span class="match-score">${match.score2}</span>
                            </div>
                        `;
                    }
                }
            });
        }
        
        // ============================================
        // –ò–ú–ü–û–†–¢/–≠–ö–°–ü–û–†–¢
        // ============================================
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `dhl_hockey_backup_${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showMessage("adminMessage", "‚úÖ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!", "success");
        }
        
        function importData() {
            document.getElementById("importFile").click();
        }
        
        function handleImportFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    appData = importedData;
                    saveData();
                    updateAllSections();
                    showMessage("adminMessage", "‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!", "success");
                } catch (error) {
                    showMessage("adminMessage", "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö!", "error");
                    console.error(error);
                }
            };
            reader.readAsText(file);
        }
        
        // ============================================
        // –£–¢–ò–õ–ò–¢–´
        // ============================================
        function switchSection(sectionId) {
            document.querySelectorAll(".section").forEach(section => {
                section.classList.remove("active");
            });
            
            document.querySelectorAll(".nav-btn").forEach(btn => {
                btn.classList.remove("active");
            });
            
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add("active");
            }
            
            const targetButton = document.querySelector(`[data-section="${sectionId}"]`);
            if (targetButton) {
                targetButton.classList.add("active");
            }
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove("active");
        }
        
        function showMessage(elementId, text, type) {
            const element = document.getElementById(elementId);
            element.textContent = text;
            element.className = `message ${type} show`;
            
            setTimeout(() => {
                element.classList.remove("show");
            }, 5000);
        }
        
        function updateSyncStatus() {
            const now = new Date();
            const lastUpdate = new Date(appData.settings.lastUpdated);
            const diffMinutes = Math.floor((now - lastUpdate) / 60000);
            
            let statusText = "–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã";
            if (diffMinutes > 5) {
                statusText = "–î–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–ª–∏, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É";
            }
            
            document.getElementById("syncStatus").textContent = statusText;
            document.getElementById("lastSyncTime").innerHTML = `
                <i class="fas fa-clock"></i> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${lastUpdate.toLocaleTimeString()}
            `;
        }
        
        function checkForUpdates() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    const savedData = JSON.parse(saved);
                    const savedTime = new Date(savedData.settings.lastUpdated);
                    const currentTime = new Date(appData.settings.lastUpdated);
                    
                    if (savedTime > currentTime) {
                        appData = savedData;
                        updateAllSections();
                        console.log("–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ localStorage");
                    }
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:", e);
                }
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        document.addEventListener("DOMContentLoaded", init);
        
        // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ HTML
        window.adminLogin = adminLogin;
        window.adminLogout = adminLogout;
        window.switchAdminTab = switchAdminTab;
        window.showAddMatchModal = showAddMatchModal;
        window.closeModal = closeModal;
        window.saveNewMatch = saveNewMatch;
        window.editMatch = editMatch;
        window.updateMatch = updateMatch;
        window.deleteMatch = deleteMatch;
        window.simulateMatch = simulateMatch;
        window.simulateAllMatches = simulateAllMatches;
        window.generateRegularSeason = generateRegularSeason;
        window.updateContent = updateContent;
        window.updateSettings = updateSettings;
        window.exportData = exportData;
        window.importData = importData;
        window.resetData = resetData;
        window.addTeam = addTeam;
        window.updateTeams = updateTeams;
        window.updateTeamField = updateTeamField;
        window.autoFillPlayoff = autoFillPlayoff;
        window.updatePlayoffField = updatePlayoffField;
        window.switchSection = switchSection;
    </script>
</body>
</html>
